!function(e){function t(t){for(var r,o,c=t[0],s=t[1],l=t[2],u=0,m=[];u<c.length;u++)o=c[u],a[o]&&m.push(a[o][0]),a[o]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r]);for(d&&d(t);m.length;)m.shift()();return i.push.apply(i,l||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],r=!0,c=1;c<n.length;c++){var s=n[c];0!==a[s]&&(r=!1)}r&&(i.splice(t--,1),e=o(o.s=n[0]))}return e}var r={},a={0:0},i=[];function o(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=r,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="";var c=window.webpackJsonp=window.webpackJsonp||[],s=c.push.bind(c);c.push=t,c=c.slice();for(var l=0;l<c.length;l++)t(c[l]);var d=s;i.push([8,1]),n()}([,function(e){e.exports={1:"應課稅品稅項",2:"一般差餉",3:"內部稅收",4:"車輛稅",5:"罰款、沒收及罰金",6:"專利稅及特權稅",7:"物業及投資",9:"貸款、償款、供款及其他收入",10:"公用事業",11:"各項收費",21:"行政長官辦公室",22:"漁農自然護理署",23:"醫療輔助隊",24:"審計署",25:"建築署",26:"政府統計處",27:"民眾安全服務處",28:"民航處",30:"懲教署",31:"香港海關",33:"土木工程拓展署",37:"衞生署",39:"渠務署",42:"機電工程署",44:"環境保護署",45:"消防處",46:"公務員一般開支",47:"政府總部：政府資訊科技總監辦公室",48:"政府化驗所",49:"食物環境衞生署",51:"政府產業署",53:"政府總部：民政事務局",55:"政府總部：商務及經濟發展局(通訊及創意產業科)",59:"政府物流服務署",60:"路政署",62:"房屋署",63:"民政事務總署",70:"入境事務處",72:"廉政公署",74:"政府新聞處",76:"稅務局",78:"知識產權署",79:"投資推廣署",80:"司法機構",82:"屋宇署",90:"勞工處",91:"地政總署",92:"律政司",94:"法律援助署",95:"康樂及文化事務署",96:"政府總部：海外經濟貿易辦事處",100:"海事處",106:"雜項服務",112:"立法會行政管理委員會",114:"申訴專員公署",116:"破產管理署",118:"規劃署",120:"退休金",121:"獨立監察警方處理投訴委員會",122:"香港警務處",135:"政府總部：創新及科技局",136:"公務員敍用委員會秘書處",137:"政府總部：環境局",138:"政府總部：發展局(規劃地政科)",139:"政府總部：食物及衞生局(食物科)",140:"政府總部：食物及衞生局(衞生科)",141:"政府總部：勞工及福利局",142:"政府總部：政務司司長辦公室及財政司司長辦公室",143:"政府總部：公務員事務局",144:"政府總部：政制及內地事務局",147:"政府總部：財經事務及庫務局(庫務科)",148:"政府總部：財經事務及庫務局(財經事務科)",151:"政府總部：保安局",152:"政府總部：商務及經濟發展局(工商及旅遊科)",155:"政府總部：創新科技署",156:"政府總部：教育局",158:"政府總部：運輸及房屋局(運輸科)",159:"政府總部：發展局(工務科)",160:"香港電台",162:"差餉物業估價署",163:"選舉事務處",166:"政府飛行服務隊",168:"香港天文台",169:"截取通訊及監察事務專員秘書處",170:"社會福利署",173:"在職家庭及學生資助事務處",174:"公務及司法人員薪俸及服務條件諮詢委員會聯合秘書處",180:"電影、報刊及物品管理辦事處",181:"工業貿易署",184:"轉撥各基金的款項",186:"運輸署",188:"庫務署",190:"大學教育資助委員會",194:"水務署",701:"土地徵用",702:"港口及機場發展",703:"建築物",704:"渠務",705:"土木工程",706:"公路",707:"新市鎮及市區發展",708:"非經常資助金及主要系統設備",709:"水務",710:"電腦化計劃",711:"房屋"}},function(e){e.exports={1:"Duties",2:"General Rates",3:"Internal Revenue",4:"Motor Vehicle Taxes",5:"Fines",6:"Royalties and Concessions",7:"Properties and Investments",9:"Loans",10:"Utilities",11:"Fees and Charges",21:"Chief Executive's Office",22:"Agriculture",23:"Auxiliary Medical Service",24:"Audit Commission",25:"Architectural Services Department",26:"Census and Statistics Department",27:"Civil Aid Service",28:"Civil Aviation Department",30:"Correctional Services Department",31:"Customs and Excise Department",33:"Civil Engineering and Development Department",37:"Department of Health",39:"Drainage Services Department",42:"Electrical and Mechanical Services Department",44:"Environmental Protection Department",45:"Fire Services Department",46:"General Expenses of the Civil Service",47:"Government Secretariat: Office of the Government Chief Information Officer",48:"Government Laboratory",49:"Food and Environmental Hygiene Department",51:"Government Property Agency",53:"Government Secretariat: Home Affairs Bureau",55:"Government Secretariat: Commerce and Economic Development Bureau (Communications and Creative Industries Branch)",59:"Government Logistics Department",60:"Highways Department",62:"Housing Department",63:"Home Affairs Department",70:"Immigration Department",72:"Independent Commission Against Corruption",74:"Information Services Department",76:"Inland Revenue Department",78:"Intellectual Property Department",79:"Invest Hong Kong",80:"Judiciary",82:"Buildings Department",90:"Labour Department",91:"Lands Department",92:"Department of Justice",94:"Legal Aid Department",95:"Leisure and Cultural Services Department",96:"Government Secretariat: Overseas Economic and Trade Offices",100:"Marine Department",106:"Miscellaneous Services",112:"Legislative Council Commission",114:"Office of The Ombudsman",116:"Official Receiver's Office",118:"Planning Department",120:"Pensions",121:"Independent Police Complaints Council",122:"Hong Kong Police Force",135:"Government Secretariat: Innovation and Technology Bureau",136:"Public Service Commission Secretariat",137:"Government Secretariat: Environment Bureau",138:"Government Secretariat: Development Bureau (Planning and Lands Branch)",139:"Government Secretariat: Food and Health Bureau (Food Branch)",140:"Government Secretariat: Food and Health Bureau (Health Branch)",141:"Government Secretariat: Labour and Welfare Bureau",142:"Government Secretariat: Offices of the Chief Secretary for Administration and the Financial Secretary",143:"Government Secretariat: Civil Service Bureau",144:"Government Secretariat: Constitutional and Mainland Affairs Bureau",147:"Government Secretariat: Financial Services and the Treasury Bureau (The Treasury Branch)",148:"Government Secretariat: Financial Services and the Treasury Bureau (Financial Services Branch)",151:"Government Secretariat: Security Bureau",152:"Government Secretariat: Commerce and Economic Development Bureau (Commerce",155:"Government Secretariat: Innovation and Technology Commission",156:"Government Secretariat: Education Bureau",158:"Government Secretariat: Transport and Housing Bureau (Transport Branch)",159:"Government Secretariat: Development Bureau (Works Branch)",160:"Radio Television Hong Kong",162:"Rating and Valuation Department",163:"Registration and Electoral Office",166:"Government Flying Service",168:"Hong Kong Observatory",169:"Secretariat",170:"Social Welfare Department",173:"Working Family and Student Financial Assistance Agency",174:"Joint Secretariat for the Advisory Bodies on Civil Service and Judicial Salaries and Conditions of Service",180:"Office for Film",181:"Trade and Industry Department",184:"Transfers to Funds",186:"Transport Department",188:"Treasury",190:"University Grants Committee",194:"Water Supplies Department",701:"Land Acquisition",702:"Port and Airport Development",703:"Buildings",704:"Drainage",705:"Civil Engineering",706:"Highways",707:"New Towns and Urban Area Development",708:"Capital Subventions and Major Systems and Equipment",709:"Waterworks",710:"Computerisation",711:"Housing"}},function(e,t,n){var r=n(4);"string"==typeof r&&(r=[[e.i,r,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};n(6)(r,a);r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(5)(!1)).push([e.i,"* {\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\n}\n\n.tooltip{\n    position: absolute;\n    text-align: left;\n    z-index: 999;\n    visibility: hidden;\n    color: white;\n    padding: 9px;\n    background-color: rgba(0, 0, 0, 0.75);\n    border-radius: 6px;\n    font: 12px sans-serif;\n}\n\n.screen-size-reminder {\n    display: flex;\n    text-align: center;\n    justify-content: center;\n}\n.screen-size-reminder p{\n    flex:100%;\n    font-size: 17px;\n    color: white;\n    font-weight: 600;\n}\n\n#head{\n    position:sticky;\n    top: 30px;\n    text-align: center\n}\n\n#toolbar {\n    position: sticky;\n    top: 0;\n}\n#toolbar, button {\n    z-index: 999;\n}\n#canvas{\n    z-index: 0;\n}\n#legend{\n    float: right;\n    position: sticky;\n    top:0;\n    right: 50px;\n}\n#legend-des, #legend-item{\n    display: block;\n}\n\n#legend-item p, #legend-item span{\n    display: inline-block;\n}\n.legend-bubble{\n    width: 15px;\n    height: 15px;\n    border-radius: 50%\n}\n#legend-des{\n    color: rgba(200, 200, 200, 0.75);\n}\n#legend0{\n    background-color:rgba(200, 200, 200, 0.5)\n}\n#legend1{\n    background-color: rgba(30, 30, 255, 0.5)\n}\n#legend2{\n    background-color: rgba(0, 0, 0, 0.5)\n}\n\nbody{\n    background: linear-gradient(to bottom right, rgba(102, 153, 255, 0.5), rgba(102, 102, 255, 0.5))\n}\n\n/* block on small screen */\n.block-on-small-screen {\n    display: none;\n}\n@media only screen and (min-width: 1024px){\n    .screen-size-reminder {\n        display: none;\n    }\n    .block-on-small-screen {\n        display: block;\n    }\n    body{\n        background: none;\n    }\n}",""])},,,,function(e,t,n){"use strict";n.r(t);n(3);var r=n(0);const a=()=>{let e=50,t=0;r.j("#canvas").select(".exit_group").selectAll("circle").transition().duration(2e3).attr("cy",100).attr("cx",n=>{let r=e+n.r+10*++t;return e+=2*n.r,r})};var i=(e,t)=>{a();const n=r.g(e=>t(e.Budget)<40?-250:250).strength(e=>t(e.Budget)<40?.01:.05),i=r.h().strength(e=>t(e.Budget)<40?.01:.05);e.force("y",i),e.force("x",n).alphaTarget(.3).restart()};const o=e=>{const t=[];return e.map(e=>{t.indexOf(e.Head)<0&&t.push(e.Head)}),t};var c=(e,t)=>{r.j(".exit_group").selectAll("circle").attr("visibility","hidden");const n=document.querySelector("body").offsetWidth,a=o(e),i=r.g(e=>a.indexOf(e.Head)%8*110-n/2+100).strength(.06),c=r.h(e=>{let t=a.indexOf(e.Head);return 100*Math.floor(t/10)-350}).strength(.06);t.force("y",c),t.force("x",i).alphaTarget(.6).restart()};var s=(e,t)=>{r.j(".exit_group").selectAll("circle").attr("visibility","visible");const n=r.g(0).strength(0),a=r.h(0).strength(0),i=r.e(e=>200-t(e.Budget)/80*200).strength(.03);e.force("y",a),e.force("x",n),e.force("r",i)},l=n(1),d=n(2);const u=async()=>{const e=`data/20${window.year}/fin_provision/fin_provision_eng_20${window.year}.csv`;return await r.a(e,e=>({Head:+e.Head,Programme:+e["Programme No."],"Programme Name":e["Programme Name"],Sector:e.Sector}))},m=(e,t,n)=>e.filter(e=>e.Head===t).filter(e=>e.Programme==n)[0];var p=e=>{let t=!0,n=l,a=null;const i=document.querySelector("#languageSwitch");i.addEventListener("change",o=>{t="chi"===i.options[i.selectedIndex].value,n=t?l:d,r.j("#head p").html(""),e.attr("stroke-width",0),t||u().then(e=>{a=e})});const o=r.j(".tooltip");e.on("mouseover",function(e){let n="";if(t)n=`${e["Programme Name"]}<br>${e.Sector}<br>${e.Budget} 百萬`;else{let t=m(a,e.Head,e.Programme);n=`${t["Programme Name"]}<br>${t.Sector}<br>${e.Budget} million`}o.html(n),o.style("visibility","visible"),r.j(this).transition().duration(300).style("opacity",1)}).on("mousemove",()=>{o.style("top",`${r.b.pageY-10}px`).style("left",`${r.b.pageX+10}px`)}).on("mouseout",function(e){o.style("visibility","hidden"),r.j(this).transition().duration(300).style("opacity",.5)}).on("click",a=>{let i=a.Head;r.j("#head p").html(`${t?"總目： ":"Head: "}${n[i]}`),e.attr("stroke-width",0),e.each(function(e){e.Head===i&&r.j(this).attr("stroke","black").attr("stroke-width",3)})})};var g=(e,t,n,a)=>{r.j(".exit_group").selectAll("circle").attr("visibility","hidden");const i=e.map(e=>e.Budget).sort((e,t)=>t-e).slice(0,10),o=r.h(e=>e.Budget>=i[9]?i.indexOf(e.Budget)<5?-250:-100:300).strength(e=>e.Budget>=i[9]?.1:.01);let c=-400,s=i.map((e,n)=>{let r=t(e);return 5===n&&(c=-400),c=c+2*r+30});const l=r.g(e=>{if(e.Budget>=i[9]){let t=i.indexOf(e.Budget);return t%5?s[t-1]:-400}return 0}).strength(e=>e.Budget>=i[9]?.1:.01);n.force("y",o),n.force("x",l).alphaTarget(.4).restart()};var f=(e,t)=>{r.j("#canvas").select(".exit_group").selectAll("circle").transition().duration(1e3).attr("r",0).remove();let n=[];e.exit().transition().duration(2e3).attr("fill","black").attr("r",function(e){return n.push({r:t(e.Budget),Head:e.Head,Programme:e.Programme,"Programme Name":e["Programme Name"],Sector:e.Sector,Budget:e.Budget,id:`${+e.Head}-${e["Programme Name"]}-${e.Sector}`}),0}).remove(),n=n.sort((e,t)=>t.r-e.r);let a=50;const i=r.j("#canvas").select(".exit_group").selectAll("circle").data(n,e=>e.id).enter().append("circle").attr("cx",100).attr("cy",e=>{let t=a+e.r+10*n.indexOf(e);return a+=2*e.r,t}).attr("fill","rgb(0, 0, 0)").style("opacity",.5).attr("r",0);i.transition().duration(2e3).attr("r",function(e){return e.r}),p(i)};const v=(e,t,n)=>{const a=r.g(0).strength(.03),i=r.h(-100).strength(.03),o=r.f().force("x",a).force("y",i).force("collide",r.d(e=>t(e.Budget)+1));return o.nodes(e).on("tick",()=>{n.attr("cx",e=>e.x).attr("cy",e=>e.y)}),o},h=(e,t,n,r)=>{p(e),document.querySelector("#sort").addEventListener("click",e=>{i(r,n)}),document.querySelector("#splitToGroup").addEventListener("click",e=>{c(t,r,n)}),document.querySelector("#combine").addEventListener("click",e=>{s(r,n)}),document.querySelector("#top10").addEventListener("click",a=>{g(t,n,r,e)})},y=e=>{window.year=e,r.a(`data/20${e}/fin_provision/fin_provision_chi_20${e}.csv`,t=>({Head:+t["總目"],Programme:+t["綱領編號"],"Programme Name":t["綱領"],Sector:t["機構"],Budget:+t[`20${e}-${e+1}`],id:`${+t["總目"]}-${t["綱領"]}-${t["機構"]}`})).then(e=>{e.columns=["Head","Programme","Programme Name","Sector","Budget"],(e=>{const t=document.querySelector("body").offsetWidth,n=0,a=30,i=t-a-20,o=1400-n-30,c=(r.j(".chart-container").attr("width",t).attr("height",1400),r.j("#canvas").attr("width",i).attr("height",o).attr("transform",`translate(${a}, ${n})`).append("g").attr("class","update_group").attr("transform",`translate(${i/2}, 400)`));r.j("#canvas").append("g").attr("class","exit_group");const s=r.c(e.map(e=>e.Budget)),l=r.i().domain(s).range([5,80]),d=c.selectAll(".artist").data(e,e=>e.id).enter().append("circle").attr("class","artist").attr("r",function(e){return l(e.Budget)}).attr("fill","rgb(200, 200, 200)").style("opacity",.5),u=v(e,l,d);h(d,e,l,u)})(e)})},S=async e=>{let t=await(async e=>{let t=`data/20${e}/fin_provision/fin_provision_chi_20${e}.csv`,n=await r.a(t,t=>({Head:+t["總目"],Programme:+t["綱領編號"],"Programme Name":t["綱領"],Sector:t["機構"],Budget:+t[`20${e}-${e+1}`],id:`${+t["總目"]}-${t["綱領"]}-${t["機構"]}`}));return n.columns=["Head","Programme","Programme Name","Sector","Budget"],n})(e);const n=r.c(t.map(e=>e.Budget)),a=r.i().domain(n).range([5,80]);let i=r.j("#canvas").select("g").selectAll("circle").data(t,function(e){return e.id});f(i,a),i.enter().append("circle").attr("r",0).attr("class","artist").attr("class","newly-added").merge(i).transition().duration(2e3).attr("r",function(e){return a(e.Budget)}),r.j("#canvas").select(".update_group").selectAll(".newly-added").attr("fill","rgb(30, 30, 255)").style("opacity",.5),i=r.j("#canvas").select(".update_group").selectAll("circle");const o=v(t,a,i);h(i,t,a,o)};screen.width>=1023&&y(15);const b=document.querySelector("#yearOptions");b.addEventListener("change",()=>{let e=+b.options[b.selectedIndex].value;window.year=e,S(e),document.querySelector("#languageSwitch").value="chi",r.j("#head p").html("")})}]);